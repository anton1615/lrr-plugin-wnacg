# Wnacg Downloader for LANraragi

A custom downloader plugin for [LANraragi](https://github.com/Difegue/LANraragi) designed to fetch manga from Wnacg and automatically package them into ZIP files.

## Features
- **Full Auto-Download**: Supports direct ZIP extraction or image list fetching from Wnacg URLs.
- **URL Normalization**: Handles `photos-index`, `photos-slide`, and `aid-xxxx` formats automatically.
- **Multi-Domain Support**: Compatible with `wnacg.com`, `wnacg.org`, and `wnacg.net`.
- **Modern Implementation**: Built using `Mojo::UserAgent` for robust connection handling and anti-hotlinking bypass.

## Requirements
- LANraragi v0.8.0 or higher.
- `Mojo::UserAgent` (pre-installed in official LANraragi images).

## Installation

### 1. NixOS (Declarative via Flakes - Recommended)
The most elegant way to install this plugin is via Nix Flakes. This automates hash management.

**Step 1: Add to your `flake.nix` inputs**
```nix
inputs.lrr-plugin-wnacg = {
  url = "https://raw.githubusercontent.com/anton1615/lrr-plugin-wnacg/master/Wnacg.pm";
  flake = false;
};
```

**Step 2: Use in your LANraragi configuration**
```nix
{ inputs, ... }:
{
  virtualisation.oci-containers.containers.lanraragi.volumes = [
    "${inputs.lrr-plugin-wnacg}:/home/koyomi/lanraragi/lib/LANraragi/Plugin/Download/Wnacg.pm:ro"
  ];
}
```

**Step 3: Update and Deploy**
```bash
nix flake update lrr-plugin-wnacg
sudo nixos-rebuild switch --flake .
```

### 2. Traditional NixOS (fetchurl)
If you are not using Flakes, add the following to your configuration:

```nix
let
  wnacgPlugin = pkgs.fetchurl {
    url = "https://raw.githubusercontent.com/anton1615/lrr-plugin-wnacg/master/Wnacg.pm";
    sha256 = "sha256-o5nPwMvg/mbkylquwtwFREfMjtxoBAN125awFyxdYc4=";
  };
in {
  virtualisation.oci-containers.containers.lanraragi.volumes = [
    "${wnacgPlugin}:/home/koyomi/lanraragi/lib/LANraragi/Plugin/Download/Wnacg.pm:ro"
  ];
}
```

### 3. Manual Installation
1. Download `Wnacg.pm` from this repository.
2. Place it in the `/lib/LANraragi/Plugin/Sideloaded/` directory of your LANraragi installation.
3. Restart LANraragi.
4. Enable the plugin via **Configuration** -> **Plugins** -> **Downloader Plugins**.

## Technical Details
- **Developer**: Code automatically generated and optimized by **Gemini CLI Agent**.
- **Test Environment**: NixOS 25.11, LANraragi 0.9.60 (Docker).
- **Logic**: Prioritizes Wnacg's official direct ZIP download page; falls back to image list scraping if ZIP is unavailable.

## License
Licensed under the [MIT License](LICENSE).

---
*Generated by Gemini CLI Agent*